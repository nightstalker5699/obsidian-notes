# Explanation of Feedback System Transition from Custom Data Type to Relational Table

The two files describe a transition from using a custom data type (array-based) to store feedback to using a proper relational table structure. Here's a breakdown of the key concepts with examples:

## Initial Approach: Custom Data Type (Array-based)

In the first implementation (175 - Adding Feedback To A Course), feedback was stored as an array of a custom type within the course table:

```sql
-- Initial approach: Adding feedback to a course as an array element
UPDATE course 
SET feedback = array_append(feedback, 
    ROW('fc7371', 5, 'Great course')::feedback
)
WHERE course_id = 'some-id';
```

**Problems with this approach:**
1. No data integrity checks (could insert feedback for non-existent students)
2. Complex queries required for simple operations
3. Need to update the entire course record just to add feedback
4. No proper relationships between entities
5. Difficult to query individual feedback items

Example of the problems:
```sql
-- This would work even if student 'fc7371' doesn't exist
UPDATE course 
SET feedback = array_append(feedback, 
    ROW('fake-student', 70, 'Fake review')::feedback  -- 70 is invalid rating
)
WHERE course_id = 'some-id';
```

## Improved Approach: Relational Table

In the second file (176 - A Tale Of 2 Feedbacks), the solution is to create a proper feedback table with relationships:

```sql
-- Creating the feedback table
CREATE TABLE feedback (
    student_id UUID NOT NULL REFERENCES student(student_id),
    course_id UUID NOT NULL REFERENCES course(course_id),
    feedback_text TEXT,
    rating SMALLINT CHECK (rating BETWEEN 0 AND 5),
    PRIMARY KEY (student_id, course_id)
);
```

**Advantages of this approach:**
1. Proper relationships via foreign keys
2. Data integrity constraints
3. Simpler queries
4. Better performance for querying feedback
5. More flexible for future needs

Example of inserting feedback:
```sql
-- Inserting feedback with proper relationships
INSERT INTO feedback (student_id, course_id, feedback_text, rating)
VALUES ('real-student-id', 'real-course-id', 'Great course', 4);
```

**Key differences demonstrated:**

| Aspect | Custom Data Type (Array) | Relational Table |
|--------|--------------------------|------------------|
| Data Integrity | No checks | Foreign keys + constraints |
| Query Complexity | Complex array operations | Simple SELECT/INSERT |
| Performance | Poor for large arrays | Optimized for queries |
| Relationships | Implicit, no enforcement | Explicit with constraints |
| Updates | Need to update entire course | Can update individual feedback |

## When to Use Each Approach

**Use custom data types when:**
- The data is truly hierarchical and belongs to the parent
- You rarely need to query individual elements
- The data has a fixed, simple structure
- Example: Phone numbers for a contact (as mentioned in the transcript)

**Use relational tables when:**
- The data needs to be queried independently
- You need data integrity constraints
- The data has relationships with other entities
- Example: Student feedback for courses

The transition shown in these files demonstrates moving from a less appropriate data model to one that better fits the requirements of a feedback system where data integrity and queryability are important.