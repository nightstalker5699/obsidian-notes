# Docker Volume Configuration Notes

## Core Issue with Volumes
- When mapping entire project directory (`-v $(pwd):/app`):
  - Overwrites container's `node_modules` with local version
  - Problem: Local `node_modules` was deleted to avoid duplication
  - Results in "React Scripts not found" error (missing dependencies)

## The Solution: Bookmarking node_modules
- Add second volume flag to preserve container's `node_modules`:
  ```bash
  docker run -p 3000:3000 \
    -v /app/node_modules \  # Bookmark container's node_modules
    -v $(pwd):/app \       # Map local files to container
    <image_id>
  ```
- **Key Syntax Difference**:
  - With colon (`:`): Maps host â†” container directories
  - Without colon: Preserves container directory (bookmark)

## How It Works
1. `-v /app/node_modules`:
   - Tells Docker to keep container's `node_modules` intact
   - Prevents overwrite from local filesystem

2. `-v $(pwd):/app`:
   - Maps all local project files to container's `/app`
   - Excludes `node_modules` due to first volume rule

## Development Workflow Benefits
- Automatic file synchronization:
  - Changes to local files (e.g., `src/App.js`) instantly reflect in container
  - No need to rebuild image after every change
  - React development server auto-reloads changes

## Key Commands
```bash
# Build development image
docker build -f Dockerfile.dev .

# Run with proper volume mapping (Linux/Mac/Git Bash)
docker run -p 3000:3000 \
  -v /app/node_modules \
  -v $(pwd):/app \
  <image_id>

# Windows (PowerShell/CMD) alternative:
docker run -p 3000:3000 `
  -v /app/node_modules `
  -v ${PWD}:/app `
  <image_id>
```

## Common Pitfalls
1. **Windows Users**:
   - `$(pwd)` only works in Git Bash
   - Use `${PWD}` in PowerShell/CMD

2. **Dependency Duplication**:
   - Always delete local `node_modules` after building image
   ```bash
   rm -rf node_modules
   ```

3. **Port Conflicts**:
   - Ensure port 3000 isn't already in use
   - Change first port number if needed (e.g., `-p 3001:3000`)