
### 1. Routing with Nginx (`13. Routing with Nginx.txt`)

This file explains how to configure the Nginx routing rules discussed previously, using a special configuration file called `default.conf`.

- **`default.conf` File:** This file contains instructions for Nginx. It will be placed inside a new `nginx` directory in the project.
- **Upstream Servers:**
    - The configuration defines "upstream" servers, which are the backend services Nginx will route traffic to (like the React client and the Express API server).
    - It defines an upstream named `client` pointing to `client:3000` (the React development server's default). The name `client` corresponds to the service name in the `docker-compose.yml` file.
    - It defines another upstream for the Express server. To avoid conflicts with the Nginx keyword `server`, this service and upstream are named `api` instead of `server`. It points to `api:5000` (the port defined in the Express app).
- **Server Block:**
    - Nginx is configured to listen on port 80 within its container. This internal port will later be mapped to a host port in Docker Compose.
- **Location Blocks (Routing Rules):**
    - `location /`: Handles requests to the root path. These are proxied (forwarded) to the `client` upstream (the React app).
    - `location /api`: Handles requests starting with `/api/`. These are proxied to the `api` upstream (the Express server).
    - **Rewrite Rule:** Before proxying `/api` requests, a `rewrite` rule is used. It matches `/api/(.*)` and rewrites the URL to `/$1`, effectively removing the `/api` prefix before the request reaches the Express server. The `break` flag prevents further rewrite rules from being applied.
- **Next Step:** The file concludes by stating that this `default.conf` file needs to be incorporated into a custom Nginx Docker image using a Dockerfile.

### 2. Building a Custom Nginx Image (`14. Building a Custom Nginx Image.txt`)

This file describes how to create a custom Docker image for Nginx that includes the `default.conf` configuration file and how to integrate it into the Docker Compose setup.

- **Dockerfile (`Dockerfile.dev`):**
    - A new Dockerfile (`Dockerfile.dev`) is created inside the `nginx` directory.
    - It starts `FROM nginx` to use the official Nginx image as a base.
    - It uses a `COPY` instruction to copy the local `./default.conf` file into the image at `/etc/nginx/conf.d/default.conf`. This specific path is where Nginx looks for configuration files, and copying the file here overwrites the default configuration provided by the base image.
    - No `CMD` or `ENTRYPOINT` is needed because the base `nginx` image already has one that starts the Nginx server.
- **Docker Compose Integration:**
    - A new service named `nginx` is added to the `docker-compose.yml` file.
    - `restart: always` policy is added because the Nginx router is critical for the application to function.
    - The `build` context is set to the `./nginx` directory, and the `dockerfile` is specified as `Dockerfile.dev`.
    - `ports` mapping is configured (e.g., `3050:80`) to expose the Nginx container's port 80 on the host machine's port 3050, allowing browser access.

In summary, these files detail the process of:

1. Writing the specific Nginx configuration (`default.conf`) to handle path-based routing between a React frontend and an Express backend.
2. Creating a simple Dockerfile to build a custom Nginx image containing this configuration.
3. Adding and configuring this custom Nginx service within the `docker-compose.yml` file to act as the application's entry point.